
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://xcomponent.github.io/Getting%20Started/appcontrol_worker/">
      
      
        <link rel="prev" href="../../openfaas/synchronous/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>Using the AppControl Worker to implement an XC Scenario task - AppControl</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#contents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AppControl" class="md-header__button md-logo" aria-label="AppControl" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AppControl
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Using the AppControl Worker to implement an XC Scenario task
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://xcomponent.github.io/appcontrol-documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Xcomponent
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AppControl" class="md-nav__button md-logo" aria-label="AppControl" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AppControl
  </label>
  
    <div class="md-nav__source">
      <a href="https://xcomponent.github.io/appcontrol-documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Xcomponent
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Get started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to create your application map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dynamicmapinformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enrich your application with dynamic informations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deploy your own agents
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Deploy your own agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install AppControl Agent to execute the components actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../azure/agentazure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to supervise and monitor Azure resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../x4bcli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install your gateways
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Install%20standalone/standalone/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install standalone
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AppControl Cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../centreon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to import your Centreon setup into AppControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cmdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to integrate AppControl with a ServiceNow Cmdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bestpractices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best practices
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Interactions between AppControl and Scenario
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Interactions between AppControl and Scenario
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openfaas/synchronous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using an OpenFaaS function to implement an XC Scenario task
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Using the AppControl Worker to implement an XC Scenario task
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Using the AppControl Worker to implement an XC Scenario task
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#benefits-of-using-appcontrol" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of using AppControl
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#benefits-of-using-appcontrol" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of using AppControl
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="contents">Contents</h1>
<p>This document describes how to use AppControl to execute a script or program as
a task in XC Scenario. It shows how to define the script invocation in an
AppControl map, how to test it directly from AppControl, and finally how to use
it from Scenario.</p>
<h2 id="benefits-of-using-appcontrol">Benefits of using AppControl</h2>
<p>There are many advantages to running scripts through AppControl, as opposed to
running them directly from a worker task:</p>
<ul>
<li>
<p>the use of an AppControl agent for execution makes it easy to run scripts on
  remote machines, without requiring the script author to manage remote
  connections and logins himself</p>
</li>
<li>
<p>executions through AppControl will benefit from monitoring and supervision by
  the production support team</p>
</li>
<li>
<p>defining script calls in an AppControl map allows for better tracking and
  management of the script code base</p>
</li>
</ul>
<h1 id="pre-requisites">Pre-requisites</h1>
<p>This document assumes that you have access to a working X4B installation,
either <a href="https://x4b.xcomponent.com/">Invivoo's SaaS platform</a>, or an X4B
platform deployed on your premises.</p>
<p>This includes XC Scenario, XC AppControl, and an AppControl worker (detailed
below) deployed and configured to interact with this AppControl instance.
Contact the administrator of your X4B platform to make sure that all the
required components are available and properly configured.</p>
<h2 id="appcontrol-worker">AppControl Worker</h2>
<p>The AppControl worker is a standalone program that acts as a worker program for
Scenario:</p>
<ul>
<li>it publishes a catalog of tasks</li>
<li>it polls the task queue for tasks to execute</li>
<li>it runs tasks and posts task statuses</li>
</ul>
<p>Unlike other worker programs that implement their own tasks, the AppControl
worker:</p>
<ul>
<li>gets its list of tasks from custom actions in AppControl maps</li>
<li>runs tasks by calling custom actions that get executed by an AppControl agent</li>
</ul>
<p>The AppControl worker must be configured to communicate with an AppControl
server through a <em>gateway</em>, which is defined inside AppControl, and is
associated with a specific AppControl user.</p>
<h1 id="defining-scripts-for-the-appcontrol-worker">Defining scripts for the AppControl worker</h1>
<p>Scripts that are meant to be used with the AppControl worker need to be defined
inside an AppControl map, as custom actions attached to some AppControl
component.</p>
<h2 id="custom-actions">Custom actions</h2>
<p>A custom action is defined by an <code>action</code> element (inside a <code>component</code>
element) with a <code>name="custom"</code> attribute. Other important attributes are
<code>commandname</code>, which lets you identify each custom action, and <code>value</code>, which
holds the actual command to execute.</p>
<p>The contents of the <code>value</code> attribute are sent to the AppControl agent for
execution, so the platform where the agent is running determines the actual
shell script language to use, Windows command/batch script or linux/unix-like
shell script.</p>
<p>The <code>action</code> element can have <code>parameters</code> and <code>outputParameters</code> sub-elements,
for input and output parameters, respectively.</p>
<p>The <code>action</code> element also has a <code>visibility</code> attribute, which controls whether
the action is accessible from outside AppControl or not. The AppControl worker
only retrieves public tasks, so if a custiom action is to be used with Scenario,
it is mandatory to specify <code>visibility="public"</code>.</p>
<p>See the <a href="../map/">AppControl map documentation</a> for more details.</p>
<h3 id="example">Example</h3>
<p>The following XML snippet is an excerpt from an AppControl map that defines a
component named <code>"comp"</code> (you can find the map file <a href="map%2Cv1.xml">here</a>). This
component has a <code>check</code> action (mandatory) and two custom actions named <code>calc</code>
and <code>prod_div</code>.</p>
<pre><code class="language-xml">&lt;component name=&quot;comp&quot; description=&quot;Script execution component&quot; hostref=&quot;LOCAL&quot; authref=&quot;LOCAL&quot; redirectoutput=&quot;false&quot; type=&quot;file&quot;&gt;
    &lt;action value=&quot;echo 1&quot; name=&quot;check&quot; /&gt;

    &lt;action value=&quot;C:\a\bin\calc_script.cmd $(arg)&quot; commandname=&quot;calc&quot; name=&quot;custom&quot; visibility=&quot;public&quot;&gt;
        &lt;parameters&gt;
            &lt;parameter name=&quot;arg&quot; value=&quot;&quot; canedit=&quot;true&quot; validation=&quot;*&quot; /&gt;
        &lt;/parameters&gt;
    &lt;/action&gt;

    &lt;action value=&quot;py c:\a\bin\pycalc.py $(operand1) $(operand2)&quot; commandname=&quot;prod_div&quot; name=&quot;custom&quot; visibility=&quot;public&quot;&gt;
        &lt;parameters&gt;
            &lt;parameter name=&quot;operand1&quot; canedit=&quot;true&quot; validation=&quot;\d+&quot; /&gt;
            &lt;parameter name=&quot;operand2&quot; canedit=&quot;true&quot; validation=&quot;\d+&quot; /&gt;
        &lt;/parameters&gt;
        &lt;outputParameters&gt;
            &lt;parameter name=&quot;product&quot; /&gt;
            &lt;parameter name=&quot;division&quot; /&gt;
        &lt;/outputParameters&gt;
    &lt;/action&gt;

&lt;/component&gt;
</code></pre>
<p>The <code>calc</code> action has a single input parameter named <code>arg</code>, defined in the
<code>parameters/parameter</code> element, and referenced with the <code>$(arg)</code> inside the
<code>value</code> attribute. This action will run the Windows command line file found at
<strong><code>C:\a\bin\calc_script.cmd</code></strong> on the agent's machine, passing it the value of
the <code>arg</code> parameter (script file <a href="calc_script.cmd">here</a>).</p>
<p>The <code>prod_div</code> action has both input and output parameters. It runs a python
script with two input parameters, calculating the product and division of these
two operands, and returning those two values. The <code>outputParameters</code> element is
used to list the names of the return values, so they can be added to the task's
description in the Scenario task catalog, and also identified in the script's
output stream
(see <a href="#A-script-with-output-parameters">A script with output parameters</a>
below).</p>
<h2 id="running-custom-actions-in-appcontrol">Running custom actions in AppControl</h2>
<p>Once the custom actions have been defined in the map file, as above, the map
must be imported into AppControl, using the <strong>New</strong> button in the UI. Please
refer to
the
<a href="https://xcomponent.github.io/appcontrol-documentation/">AppControl documentation</a> if
you need more information on how to use the AppControl UI.</p>
<p>When the <code>Architecture</code> tab is chosen to display the map's graph, the
components from the map are shown, and any custom actions defined on them will
be found on a dropdown menu accessible through a right-click:</p>
<p><img alt="customs" src="customs.png" /></p>
<h3 id="a-simple-script">A simple script</h3>
<p>If we pick the <code>calc</code> action, a dialog box (on the left) shows the command line
that will be executed, as well as the arguments that are expected (in this
case, the single parameter <code>arg</code>). Enter a value for the argument, and press
the <strong>Execute Custom Action</strong> button. The dialog box (on the right) now
displays the status of the execution, which can be <strong>InProgess</strong>, while it's
running, and then <strong>Execution Succeeded</strong> as shown here when it's finished,
with the exit code from the script on the right-hand side.</p>
<p><img alt="calc" src="calc_script.png" /></p>
<p>As scripts usually produce output from their execution by printing to their
standard output stream, the AppControl custom action captures that output
stream and displays it on the screen, below the green status line. In this
case, it's the message <code>calc_script: arg=hello</code> that was printed by the script.</p>
<h3 id="a-script-with-output-parameters">A script with output parameters</h3>
<p>A shell script does not have a notion of output parameters. But in many
situations, people write code that produces results, and we want to retrieve
those results, either for displaying in the AppControl UI, or for communicating
them to Scenario so they can be used by other tasks. </p>
<p>This second example, the <code>prod_div</code> action, illustrates this use case with a
python script that returns two output parameters, and it explains the
particular syntax that's used, in the script's standard output stream, to
represent return values so Scenario get use them.</p>
<p>The <code>pycalc</code> script (source code <a href="pycalc.py">here</a>) calls a python function
that calculates the product and division of its two operands. If we pick the
<code>prod_div</code> action in AppControl, the dialog box will shows us the command line
and input arguments (<code>operand1</code>, <code>operand2</code>), and after executing the action,
we'll also see the standard output, as before.</p>
<p><img alt="prod_div" src="prod_div.png" /></p>
<p>However, in this case, we see that the standard output has a very specific
format:</p>
<pre><code class="language-xml">&lt;appcontrol&gt;
    {
        'Message': 'pycalc: success.',
        'OutputValues': {
            'product': 72,
            'division': 8.0,
         }
    }
&lt;/appcontrol&gt;
</code></pre>
<p>Inside the <strong>&lt;appcontrol&gt;</strong> tags is an object with json/javascript syntax,
that is meant to be interpreted by the AppControl worker:</p>
<ul>
<li>
<p>the <code>Message</code> property holds some text that will be displayed in the Scenario
  UI, so it should be some kind of summary or resulting status from the
  script's execution.</p>
</li>
<li>
<p>the <code>OutputValues</code> property is a dictionary of the output parameters. It must
  match the set of parameters listed in the <code>outputParameters</code> element of the
  AppControl map (see <a href="#Example">Custom action example</a> above), and the values
  must be filled in by the script.</p>
</li>
</ul>
<h2 id="running-scriptscustom-actions-in-scenario">Running scripts/custom actions in Scenario</h2>
<p>So far, we've seen how to define our scripts in the AppControl map, and how to
run them from the AppControl UI. This section deals with using those scripts
inside Scenario.</p>
<p>If everything has been set up correctly by your administrator, as described
in <a href="#Pre-requisites">Pre-requisites</a> above, importing and loading (activating)
the map that defines your scripts is enough to make them available in
Scenario. The AppControl worker publishes all the custom actions from your map
as Scenario tasks, in a namespace called <strong>AppControl</strong>.</p>
<h1 id="using-the-script-as-a-scenario-task">Using the script as a Scenario task</h1>
<p>In the Scenario designer, when creating or modifying a scenario definition,
drag and drop an automatic task object (the one with the gears icon, called
<strong>Task</strong>), and select the <strong>AppControl</strong> namespace in the Task Parameters
panel. In the list of tasks, you can see two tasks from the <strong><code>map,v1.xml</code></strong>
file, with names:</p>
<ul>
<li>map,v1@admin__comp_calc</li>
<li>map,v1@admin__comp_prod_div</li>
</ul>
<p>The structure of these names reflects the AppControl artifacts:
&lt;map&gt;@&lt;user&gt;__&lt;component&gt;_&lt;action&gt;. These actions are now
available, like any other task, to be used in your scenario.</p>
<p><img alt="catalog" src="catalog.png" /></p>
<p>Select the <code>prod_div</code> task, enter values for operands 1 and 2, and then run the
scenario. In the cockpit, you can see the output values and the message, just
as we saw in the AppControl UI above:</p>
<p><img alt="execution" src="execution.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.instant.preview", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
    
  </body>
</html>